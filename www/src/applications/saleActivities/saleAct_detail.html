<ion-view class="saleActDetail">
    <div class="top-back absolute " style="height: 75px;background: none"
         ng-class="!TitleFlag&&!isAndroid?'animated fadeOut':isAndroid?'':'animated fadeIn'" ng-show="TitleFlag">
        <div class="row row-center title">
            <div class="col col-15" ng-click="goBack()"><i class="ion-chevron-left"></i></div>
            <div class="col col-70 text-center">活动详情
                <div style="font-size: 10px">{{details.DESCRIPTION?details.DESCRIPTION:'&nbsp;'}}</div>
            </div>
            <div class="col col-15 text-right" ng-click="openFollow()"></div>
        </div>
    </div>
    <div class="top-back absolute top-back2" ng-show="showTitleStatus">
        <div class="row row-center title" style="padding-bottom: 0">
            <div class="col col-15" ng-click="goBack()"><i class="ion-chevron-left"></i></div>
            <div class="col col-70 text-center">活动详情
                <div style="font-size: 10px">{{details.DESCRIPTION?details.DESCRIPTION:'&nbsp;'}}</div>
            </div>
            <div class="col col-15 text-right" ng-click="openFollow()"></div>
        </div> 
        <div class="selector">
            <div class="detail" ng-class="{checked:select}" ng-click="changeStatus(true)">详细信息</div>
            <div class="relative" ng-class="{checked:!select}" ng-click="changeStatus(false)">相关方</div>
        </div>
    </div>
    <ion-content class="has-footer" has-bouncing="true"  scrollbar-y="false">
        <div class="addRelationsModal">
            <div ng-class="processDropflag?'own-backDrop-on':'own-backDrop-off'"
                 ng-click="changeProcessDropFlag()"></div>
        </div>
        <div id="saleTopBackId" class="top-back">
            <div class="row row-center title" ng-class="TitleFlag?isAndroid?'invisible':'animated fadeOut':isAndroid?'visible':'animated fadeIn'">
                <div class="col col-15" ng-click="goBack()"><i class="ion-chevron-left"></i></div>
                <div class="col col-70 text-center">活动详情</div>
                <div class="col col-15 text-right" ng-click="openFollow()"></div>
            </div>
            <div class="mainInfo">
                <div class="row row-center" ng-class="TitleFlag?isAndroid?'invisible':'animated fadeOut':isAndroid?'visible':'animated fadeIn'">
                    <img class="title_oval" src="img/saleDetail/title_oval.png">
                    <input type="text" ng-model="details.DESCRIPTION" ng-readonly="!isEdit"
                           ng-class="{'border-bottom-white':isEdit}">
                </div>
                <div class="row row-center" ng-class="customerFlag?isAndroid?'invisible':'animated fadeOut':isAndroid?'visible':'animated fadeIn'">
                    <div class="col col-16">客户:</div>
                    <ion-scroll direction="x" scrollbar-x="false"  style="white-space:nowrap">
                        <div >{{details.customerName}}</div>
                    </ion-scroll>
                    <!--<input type="text" ng-model="details.customerName" readonly-->
                           <!--ng-class="{'border-bottom-white':isEdit}">-->
                    <div class="urgentDegree" ng-hide="isATL">
                        <select ng-model="details.urgent" ng-disabled="!isEdit" ng-options="x as x.text for x in urgentDegreeArr"></select>
                        <div ng-class="details.urgent.text.length==4?'textFour':'textFif'">{{details.urgent.text}}</div>
                    </div>
                </div>
                <div class="row row-center" ng-class="placeFlag?isAndroid?'invisible':'animated fadeOut':isAndroid?'visible':'animated fadeIn'">
                    <div class="col col-16">地点:</div>
                    <input type="text" ng-model="details.ACT_LOCATION" ng-readonly="!isEdit"
                           ng-class="{'border-bottom-white':isEdit}">
                </div>
                <div class="row row-center" ng-class="typeFlag?isAndroid?'invisible':'animated fadeOut':isAndroid?'visible':'animated fadeIn'">
                    <div class="col col-16">类型:</div>
                    <input type="text" ng-model="details.actType" style="border: none;" readonly>
                </div>
                <div class="row row-center" ng-class="statusFlag?isAndroid?'invisible':'animated fadeOut':isAndroid?'visible':'animated fadeIn'">
                    <div>状态:</div>
                    <select ng-class="{'border-bottom-white':isEdit}" ng-model="mySelect.status" ng-disabled="!isEdit"
                            ng-options="x as x.value for x in statusArr" style="{{'color:'+mySelect.status.color}}">{{mySelect.status}}</select>
                    <div class="num">{{'NO.'+details.OBJECT_ID}}</div>
                    <div class="edit" ng-click="edit()" ng-show="details.EDIT_FLAG=='X'"><img src="img/saleDetail/edit.png" ng-if="!isEdit">{{editText}}
                    </div>
                </div>
            </div>
            <div class="selector">
                <div class="detail" ng-class="{checked:select}" ng-click="changeStatus(true)">详细信息</div>
                <div class="relative" ng-class="{checked:!select}" ng-click="changeStatus(false)">相关方</div>
            </div>
        </div>

        <div class="content" id="saleContentId">
            <!--详细信息-->
            <div ng-if="select">
                <div class="row">
                    <div class="col-15">注释:</div>
                    <textarea rows="3" ng-readonly="!isEdit" ng-model="details.TEXT"></textarea>
                </div>
                <div class="row" style="padding-right: 0;">
                    <div class="row row-center">
                        <div class="col">
                            <div class="row">
                                <div class="col-30 text-left">开始时间:</div>
                                <div class="text col-70 startTime" ng-click="selectTime('start')">
                                    {{details.de_startTime}}
                                    <i class="ion-arrow-down-b"></i></div>
                            </div>
                            <div class="row endTime">
                                <div class="col-30 text-left">结束时间:</div>
                                <div class="text col-70" ng-click="selectTime('end')">{{details.de_endTime}}
                                    <i class="ion-arrow-down-b"></i></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" ng-click="openRefer()">
                    <div class="row row-center">
                        <div class="col col-85 col-center">
                            <div class="row">
                                <div class="col-30 text-left col-center">参考:</div>
                                <div class="text col-70 underline">{{details.OPPORT_NO}}<span
                                        ng-if="details.OPPORT_NO&&details.OPPORT_DESC">—</span>{{details.OPPORT_DESC}}
                                </div>
                            </div>
                        </div>
                        <div class="col col-15 text-right rewrite"><!--img src="img/saleDetail/Shape.png"--></div>
                    </div>
                </div>
                <div class="row" ng-hide="isATL">
                    <div class="row row-center">
                        <div class="col col-85 col-center">
                            <div class="row">
                                <div class="col-35 text-left col-center">活动子类型:</div>
                                <div class="text col-65 ">
                                    <input type="text" ng-model="details.ZZHDZLXSM" ng-readonly="!isEdit"
                                            placeholder="请输入活动子类型">
                                </div>
                            </div>
                        </div>
                        <div class="col col-15 text-right rewrite"><!--img src="img/saleDetail/Shape.png"--></div>
                    </div>
                </div>
                <div class="progress" ng-hide="isATL">
                    <div class="row">进展:</div>
                    <div class="obj {{x.class?x.class:'zoomInRight'}}" ng-class="isAndroid?'':'own-animated'" ng-repeat="x in makeConsensus.item">
                        <i ng-if="isEdit" class="ion-ios-close" ng-click="deleteProcess(x,makeConsensus.item,$index,'makeConsensus',$event)"></i>
                        <div class="row row-center" ng-click="openProcessModal(x,'makeConsensus',$index)">
                            <img class="oval" src="img/saleDetail/oval_green.png">
                            <div class="triAngle row row-center no-padding">
                                <div class="textType green">达成共识</div>
                                <div class="text">{{x.ZZSXNR}}</div>
                            </div>
                        </div>
                        <div class="row row-center timeRow">
                            <div class="time"></div>
                            <!--<div class="hr-line"></div>-->
                        </div>
                    </div>
                    <div class="obj own-animated {{x.class?x.class:'zoomInRight'}}" ng-repeat="x in followUpMatter.item">
                        <i ng-if="isEdit" class="ion-ios-close" ng-click="deleteProcess(x,followUpMatter.item,$index,'followUpMatter',$event)"></i>
                        <div class="row row-center" ng-click="openProcessModal(x,'followUpMatter',$index)">
                            <img class="oval" src="img/saleDetail/oval.png">
                            <div class="triAngle row row-center no-padding">
                                <div class="textType">跟进事项</div>
                                <div class="text">{{x.ZZSXNR_1}}</div>
                            </div>
                        </div>
                        <div class="row row-center timeRow">
                            <div class="time"></div>
                            <!--<div class="hr-line"></div>-->
                        </div>
                    </div>
                    <div class="obj own-animated {{x.class?x.class:'zoomInRight'}}" ng-repeat="x in policyDecode.item">
                        <i ng-if="isEdit" class="ion-ios-close" ng-click="deleteProcess(x,policyDecode.item,$index,'policyDecode',$event)"></i>
                        <div class="row row-center" ng-click="openProcessModal(x,'policyDecode',$index)">
                            <img class="oval" src="img/saleDetail/oval_rose.png">
                            <div class="triAngle row row-center no-padding">
                                <div class="textType rose">政策解读</div>
                                <div class="text">{{x.ZZSXNR_2}}</div>
                            </div>
                        </div>
                        <div class="row row-center timeRow">
                            <div class="time"></div>
                            <!--<div class="hr-line"></div>-->
                        </div>
                    </div>
                </div>

            </div>
            <!--相关方-->
            <div id="relativeId" class="relative" ng-if="!select">
                <div class="row" ng-repeat="x in relationArr" ng-click="goRelationDetail(x)" on-hold="showActionSheet(x)">
                    <div class="col col-60 col-center">{{x.NAME}}</div>
                    <div class="col position col-center text-center">{{x.position}}</div>
                </div>
                <div class="row row-center add" ng-if="isEdit&&isCanEditRelation">
                    <div class="col" ng-click="openRelations()"><i class="ion-ios-plus-outline"></i>添加相关方</div>
                </div>
            </div>
        </div>
    </ion-content>
    <div class="bar bar-footer content item-input-inset" keyboard-attach ng-hide="isATL||details.EDIT_FLAG!='X'">
        <form ng-submit="formTest()" style="width: 100%">
            <div class="submit">
                <div class="row row-center">
                    <div class="col no-padding">
                        <div class="input"><input type="text" ng-click="openProcessModal()" ng-model="process.content"/>
                        </div>
                    </div>
                    <div class="no-padding selections" ng-show="!processDropflag">
                        <select ng-model="myProcess" ng-options="x as x.text for x in processArr"></select>
                        <i class="ion-ios-arrow-down"></i>
                    </div>
                    <div class="col col-18 no-padding" ng-if="processDropflag" ng-click="submit()">
                        <button>提交</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</ion-view>
